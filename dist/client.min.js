var client=function(t){"use strict";function e(){return m.origin+"/index.html"}var i;t.WidgetType=void 0,(i=t.WidgetType||(t.WidgetType={}))[i.Iosec=0]="Iosec",i[i.Iocaptcha=1]="Iocaptcha";class n{constructor(t,e,i,n,o){this.type=t,this.formfield=e,this.id=i,this.iframe=n,this.parent=o}end(){console.log("ending"),this.iframe.remove()}}function o(t){return Math.random().toString(36).replace(/[^a-z]+/g,"").substring(0,t)}function a(t){const e=new Error(t);if(m.throw_errors)throw e;return e}function c(t,e){var i;null===(i=t.contentWindow)||void 0===i||i.postMessage(e,{targetOrigin:"*"})}const r=["new_pass_uuid"];class l{constructor(){this.events={}}connect(t,e){if(!r.includes(t))return a(`Invalid event type: ${t}, possible events: ${r.join(", ")}`);void 0===this.events[t]&&(this.events[t]=[]),this.events[t].push(e)}execute_with_implicit_dom(t,e){const i=o(16),n=document.querySelector(t);if(null===n){const t=new Error("Target element not found.");if(m.throw_errors)throw t;return t}return s(d(n,i,e))}execute(t){const e=o(16);return s(d(document.body,e,t))}}function s(i){var r,l,s,d;const u=i.getAttribute("data-pubkey");if(null==u)return a("io-sec: missing data-pubkey attribute, can't continue");const h=null!==(r=i.getAttribute("data-callback-token-refresh"))&&void 0!==r?r:"",b=window.ioclient_callbacks[h],g=null!==(l=i.getAttribute("data-callback-error"))&&void 0!==l?l:"",p=window.ioclient_callbacks[g],w=null!==(s=i.getAttribute("data-widgetid"))&&void 0!==s?s:o(5),f=null!==(d=i.getAttribute("data-action"))&&void 0!==d?d:"unspecified",_=window.document.createElement("input");_.hidden=!0,i.appendChild(_);const k=window.document.createElement("iframe");k.src=e(),k.hidden=!0,i.appendChild(k);const v=new n(t.WidgetType.Iosec,_,w,k,i);return k.onload=()=>{c(k,{method:"set_pubkey_iosec",pubkey:u}),c(k,{method:"set_widgetid_iosec",widgetid:w}),c(k,{method:"set_action_iosec",action:f}),c(k,{method:"start_iosec"}),window.addEventListener("message",(t=>{var e;if(t.origin.toString()!==m.origin.toString())return;const{id:i,method:n,uuid:o}=t.data;i===w&&("set_pass_uuid"===n?void 0!==b&&setTimeout((()=>{b(o)})):"set_error"===n?null!=p&&setTimeout((()=>{null!=p&&p(a)})):"api_hello"===n?null===(e=t.source)||void 0===e||e.postMessage({method:"hello_ui"},{targetOrigin:"*"}):"end"===n&&v.end())}))},v}function d(t,e,i){const n=document.createElement("div");if(n.className="io-sec",n.setAttribute("data-widgetid",e),n.setAttribute("data-pubkey",i.public_key),n.setAttribute("data-action",i.action),null!=i.callbackTokenRefresh){const t=o(16);window.ioclient_callbacks[t]=i.callbackTokenRefresh,n.setAttribute("data-callback-token-refresh",t)}if(null!=i.callbackError){const t=o(16);window.ioclient_callbacks[t]=i.callbackError,n.setAttribute("data-callback-error",t)}return t.appendChild(n),n}function u(i){var r,l,s,d,u,h;const b=i.getAttribute("data-pubkey");if(null==b)return a("io-captcha: missing data-pubkey attribute, can't continue");const g=null!==(r=i.getAttribute("data-callback-solve"))&&void 0!==r?r:"",p=window.ioclient_callbacks[g],w=null!==(l=i.getAttribute("data-callback-error"))&&void 0!==l?l:"",f=window.ioclient_callbacks[w],_=null!==(s=i.getAttribute("data-widgetid"))&&void 0!==s?s:o(5),k=null!==(d=i.getAttribute("data-theme"))&&void 0!==d?d:"light",v=parseFloat(null!==(u=i.getAttribute("data-scale"))&&void 0!==u?u:"1.0"),y=null!==(h=i.getAttribute("data-font"))&&void 0!==h?h:"roboto",A=window.document.createElement("input");A.hidden=!0,i.appendChild(A);const E=window.document.createElement("iframe");if(E.src=e(),E.style.overflow="visible",E.style.border="none",E.style.position="absolute",i.appendChild(E),null==E.contentWindow)return a("io-captcha: iframe.contentWindow is null");const T=new n(t.WidgetType.Iocaptcha,A,_,E,i);return E.onload=()=>{c(E,{method:"set_pubkey",pubkey:b}),c(E,{method:"set_widgetid",widgetid:_}),c(E,{method:"set_theme",theme:k}),c(E,{method:"set_scale",scale:v}),c(E,{method:"set_font",font:y}),window.addEventListener("message",(t=>{var e;if(t.origin.toString()!==m.origin.toString())return;const n=t.data;n.id===_&&("set_pass_uuid"===n.method?(!function(t,e){t.formfield.setAttribute("iocaptcha-pass-uuid",e)}(T,n.uuid),null!=g&&setTimeout((()=>{null!=p&&p(n.uuid)}))):"set_error"===n.method?null!=f&&setTimeout((()=>{null!=f&&f(n.error)})):"api_hello"===n.method?null===(e=t.source)||void 0===e||e.postMessage({method:"hello_ui"},{targetOrigin:"*"}):"size_change"===n.method?function(t,e,i){t.height=e,t.width=i}(E,n.height,n.width):"dflex_size_change_complete"===n.method&&(i.style.paddingBottom=n.height.toString()))}))},T}function h(){const t=window.document.getElementsByClassName("io-captcha");for(let e=0;e<t.length;e++){u(t[e])}}class b{constructor(t,e,i,n,o,a){this.public_key=t,this.callbackSolve=e,this.callbackError=i,this.theme=n,this.font=o,this.scale=a,this.public_key=t,this.theme=n,this.font=o,this.scale=a}}window.document.addEventListener("DOMContentLoaded",(()=>{m.scan_immediately&&h()}));const m={throw_errors:!1,scan_immediately:!0,origin:"https://hook.io.software"};try{const t=window;t.ioclient_callbacks={},t.iosec=new l}catch(t){}return t.CONFIG=m,t.CaptchaOptions=b,t.Iocaptcha=class{create(t,e,i){i=i instanceof b?i:new b(i,void 0,void 0,"light","roboto",1),e=null!=e?e:o(16);const n=document.querySelector(t);if(null===n)return a("Target element not found.");const c=function(t,e,i){const n=document.createElement("div");if(n.className="io-captcha",n.setAttribute("data-widgetid",e),n.setAttribute("data-pubkey",i.public_key),null!==i.callbackSolve){const t=o(16);window.ioclient_callbacks[t]=i.callbackSolve,n.setAttribute("data-callback-solve",t)}if(null!==i.callbackError){const t=o(16);window.ioclient_callbacks[t]=i.callbackError,n.setAttribute("data-callback-error",t)}return n.setAttribute("data-theme",i.theme),n.setAttribute("data-font",i.font),n.setAttribute("data-scale",i.scale.toString()),t.appendChild(n),u(n),n}(n,e,i);return u(c)}},t.Iosec=l,t.IosecOptions=class{constructor(t,e,i,n){this.public_key=t,this.action=e,this.callbackTokenRefresh=i,this.callbackError=n}},t.Widget=n,t.scan_and_render=h,t}({});
