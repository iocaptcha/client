var iocaptcha_client=function(t){"use strict";function e(){return h.origin+"/index.html"}var n;!function(t){t[t.Iosec=0]="Iosec",t[t.Iocaptcha=1]="Iocaptcha"}(n||(n={}));class i{constructor(t,e,n,i,o,a){this.type=t,this.ops=e,this.formfield=n,this.id=i,this.iframe=o,this.parent=a}}function o(t){return Math.random().toString(36).replace(/[^a-z]+/g,"").substring(0,t)}function a(t){const e=new Error(t);if(h.throw_errors)throw e;return e}function c(t,e){var n;null===(n=t.contentWindow)||void 0===n||n.postMessage(e,{targetOrigin:"*"})}class r{constructor(t,e,n,i){this.pubkey=t,this.action=e,this.callbackTokenRefresh=n,this.callbackError=i,this.pubkey=t,this.action=e}}const s=["new_pass_uuid"];function l(t){var r,s,l,d,b,m;const p=t.getAttribute("data-pubkey");if(null==p)return a("io-captcha: missing data-pubkey attribute, can't continue");const w=null!==(r=t.getAttribute("data-callback-solve"))&&void 0!==r?r:"",g=window.callbacks[w],f=null!==(s=t.getAttribute("data-callback-error"))&&void 0!==s?s:"",k=window.callbacks[f],v=null!==(l=t.getAttribute("data-widgetid"))&&void 0!==l?l:o(5),_=null!==(d=t.getAttribute("data-theme"))&&void 0!==d?d:"light",y=parseFloat(null!==(b=t.getAttribute("data-scale"))&&void 0!==b?b:"1.0"),A=null!==(m=t.getAttribute("data-font"))&&void 0!==m?m:"roboto",E=window.document.createElement("input");E.hidden=!0,t.appendChild(E);const S=window.document.createElement("iframe");if(S.src=e(),S.style.overflow="visible",S.style.border="none",S.style.position="absolute",t.appendChild(S),null==S.contentWindow)return a("io-captcha: iframe.contentWindow is null");const I=new u(p,g,k,_,A,y),C=new i(n.Iocaptcha,I,E,v,S,t);return S.onload=()=>{c(S,{method:"set_pubkey",pubkey:p}),c(S,{method:"set_widgetid",widgetid:v}),c(S,{method:"set_theme",theme:_}),c(S,{method:"set_scale",scale:y}),c(S,{method:"set_font",font:A}),window.addEventListener("message",(e=>{var n;if(e.origin.toString()!==h.origin.toString())return;const i=e.data;i.id===v&&("set_pass_uuid"===i.method?(!function(t,e){t.formfield.setAttribute("iocaptcha-pass-uuid",e)}(C,i.uuid),null!=w&&setTimeout((()=>{null!=g&&g(i.uuid)}))):"set_error"===i.method?null!=k&&setTimeout((()=>{null!=k&&k(i.error)})):"api_hello"===i.method?null===(n=e.source)||void 0===n||n.postMessage({method:"hello_ui"},{targetOrigin:"*"}):"size_change"===i.method?function(t,e,n){t.height=e,t.width=n}(S,i.height,i.width):"dflex_size_change_complete"===i.method&&(t.style.paddingBottom=i.height.toString()))}))},C}function d(){const t=window.document.getElementsByClassName("io-captcha");for(let e=0;e<t.length;e++){l(t[e])}}class u{constructor(t,e,n,i,o,a){this.pubkey=t,this.callbackSolve=e,this.callbackError=n,this.theme=i,this.font=o,this.scale=a,this.pubkey=t,this.theme=i,this.font=o,this.scale=a}}window.document.addEventListener("DOMContentLoaded",(()=>{h.scan_immediately&&d()}));const h={throw_errors:!1,scan_immediately:!0,origin:"https://io-sec.com"};try{const t=null!==window&&void 0!==window?window:global;t.config=h,t.callbacks={}}catch(t){}return t.CONFIG=h,t.CaptchaOptions=u,t.Iocaptcha=class{create(t,e,n){n=n instanceof u?n:new u(n,void 0,void 0,"light","roboto",1),e=null!=e?e:o(16);const i=document.querySelector(t);if(null===i)return a("Target element not found.");const c=function(t,e,n){const i=document.createElement("div");if(i.className="io-captcha",i.setAttribute("data-widgetid",e),i.setAttribute("data-pubkey",n.pubkey),null!==n.callbackSolve){const t=o(16);window.callbacks[t]=n.callbackSolve,i.setAttribute("data-callback-solve",t)}if(null!==n.callbackError){const t=o(16);window.callbacks[t]=n.callbackError,i.setAttribute("data-callback-error",t)}return i.setAttribute("data-theme",n.theme),i.setAttribute("data-font",n.font),i.setAttribute("data-scale",n.scale.toString()),t.appendChild(i),l(i),i}(i,e,n);return l(c)}},t.Iosec=class{constructor(){this.events={}}connect(t,e){if(!s.includes(t))return a(`Invalid event type: ${t}, possible events: ${s.join(", ")}`);void 0===this.events[t]&&(this.events[t]=[]),this.events[t].push(e)}create(t,s,l){s=null!=s?s:o(16);const d=document.querySelector(t);if(null===d){const t=new Error("Target element not found.");if(h.throw_errors)throw t;return t}const u=function(t,e,n){const i=document.createElement("div");if(i.className="io-sec",i.setAttribute("data-widgetid",e),i.setAttribute("data-pubkey",n.pubkey),i.setAttribute("data-action",n.action),null!=n.callbackTokenRefresh){const t=o(16);window.callbacks[t]=n.callbackTokenRefresh,i.setAttribute("data-callback-token-refresh",t)}if(null!=n.callbackError){const t=o(16);window.callbacks[t]=n.callbackError,i.setAttribute("data-callback-error",t)}return t.appendChild(i),i}(d,s,l);return function(t){var s,l,d,u;const b=t.getAttribute("data-pubkey");if(null==b)return a("io-sec: missing data-pubkey attribute, can't continue");const m=null!==(s=t.getAttribute("data-callback-token-refresh"))&&void 0!==s?s:"",p=window.callbacks[m],w=null!==(l=t.getAttribute("data-callback-error"))&&void 0!==l?l:"",g=window.callbacks[w],f=null!==(d=t.getAttribute("data-widgetid"))&&void 0!==d?d:o(5),k=null!==(u=t.getAttribute("data-action"))&&void 0!==u?u:"unspecified",v=window.document.createElement("input");v.hidden=!0,t.appendChild(v);const _=window.document.createElement("iframe");_.src=e(),_.hidden=!0,t.appendChild(_);const y=new r(b,k,p,g),A=new i(n.Iosec,y,v,f,_,t);return _.onload=()=>{c(_,{method:"set_pubkey_iosec",pubkey:b}),c(_,{method:"set_widgetid_iosec",widgetid:f}),c(_,{method:"set_action_iosec",action:k}),c(_,{method:"start_iosec"}),window.addEventListener("message",(t=>{var e;if(t.origin.toString()!==h.origin.toString())return;const{id:n,method:i,uuid:o}=t.data;n===f&&("set_pass_uuid"===i?void 0!==p&&setTimeout((()=>{p(o)})):"set_error"===i?null!=g&&setTimeout((()=>{null!=g&&g(a)})):"api_hello"===i&&(null===(e=t.source)||void 0===e||e.postMessage({method:"hello_ui"},{targetOrigin:"*"})))}))},A}(u)}},t.IosecOptions=r,t.Widget=i,t.scan_and_render=d,t}({});
